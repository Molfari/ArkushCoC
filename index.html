<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Аркуш Дослідника: Поклик Ктулху</title>
    <meta name="theme-color" content="#5a4a3a"/>
    <!-- Підключення маніфесту PWA -->
    <link rel="manifest" href="manifest.json">
    <!-- Іконки для Apple та стандартні -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
    <link rel="shortcut icon" href="assets/favicon.ico">
    <!-- Підключення шрифтів -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=Marck+Script&family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <!-- Підключення Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Підключення ваших стилів -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/diceRoller.css">
</head>
<body class="p-4 flex flex-col min-h-screen">

    <main class="flex-grow">
        <!-- Екран вибору персонажа (початково видимий) -->
        <div id="character-selection-screen">
            <div class="main-logo-container">
                <img src="assets/coc-logo.png" alt="Call of Cthulhu Logo" class="main-logo">
            </div>
            <div id="characters-list" class="characters-grid">
                <!-- Картки персонажів генеруються тут -->
            </div>
            <div class="flex justify-center mt-8">
                <button id="add-character-btn" class="add-character-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                    Новий Дослідник
                </button>
            </div>
        </div>

        <!-- Екран аркуша персонажа (початково прихований) -->
        <div id="character-sheet-screen" class="hidden">
            <div class="sheet-container relative">
                 <button id="open-dice-roller-btn" class="open-dice-roller-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 8.5L22 12l-3.5 3.5"/><path d="M12 22l3.5-3.5L12 15"/><path d="M8.5 15.5L5 12l3.5-3.5"/><path d="M12 2L8.5 5.5 12 9"/><path d="M2 12h20"/><path d="M12 2v20"/></svg>
                 </button>

                 <button id="back-to-selection-btn" class="back-btn">← Назад</button>
                <div class="tabs">
                    <button class="tab-button active" data-tab="character-sheet">Персонаж</button>
                    <button class="tab-button" data-tab="backstory-sheet">Нотатки</button>
                </div>
                <div id="character-sheet" class="tab-content active">
                    <h1>Лист Дослідника</h1>
                    <div class="header-grid" id="info-container"></div>
                    <h2>Характеристики</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4" id="stats-container"></div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mt-4" id="current-stats-container"></div>
                    <div class="status-block">
                        <h3>СТАНИ</h3>
                        <div class="status-grid">
                            <div class="checkbox-group"><input type="checkbox" id="temp_insane"><label for="temp_insane">Тимчасове божевілля</label></div>
                            <div class="checkbox-group"><input type="checkbox" id="indef_insane"><label for="indef_insane">Повне божевілля</label></div>
                            <div class="checkbox-group"><input type="checkbox" id="major_wound"><label for="major_wound">Глибока рана</label></div>
                            <div class="checkbox-group"><input type="checkbox" id="unconscious"><label for="unconscious">Непритомність</label></div>
                            <div class="checkbox-group"><input type="checkbox" id="dying"><label for="dying">При смерті</label></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-4" id="derived-stats-container"></div>
                    <h2>Вміння</h2>
                    <div class="skills-grid" id="skills-container"></div>
                    <h2>Зброя</h2>
                    <table class="weapons-table">
                        <thead><tr><th class="weapon-name-col">Зброя</th><th>Вміння %</th><th>Пошкодж.</th><th>Дальність</th><th>Атак</th><th>Набоїв</th><th>Несправн.</th></tr></thead>
                        <tbody>
                            <tr><td><input type="text" value="Рукопашний бій"></td><td><input type="number" value="25"></td><td><input type="text" value="1D3+БП"></td><td><input type="text" value="Дотик"></td><td><input type="number" value="1"></td><td><input type="text" value="-"></td><td><input type="text" value="-"></td></tr>
                            <tr><td><input type="text"></td><td><input type="number"></td><td><input type="text"></td><td><input type="text"></td><td><input type="number"></td><td><input type="text"></td><td><input type="text"></td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="backstory-sheet" class="tab-content">
                    <h2>Передісторія</h2>
                    <div class="backstory-grid">
                        <div class="backstory-item"><label>Опис зовнішності</label><textarea data-field="description"></textarea></div>
                        <div class="backstory-item"><label>Риси</label><textarea data-field="traits"></textarea></div>
                        <div class="backstory-item"><label>Переконання і вірування</label><textarea data-field="beliefs"></textarea></div>
                        <div class="backstory-item"><label>Важливі люди</label><textarea data-field="people"></textarea></div>
                    </div>
                    <h2>Нотатки</h2>
                    <div id="notes-container" class="notes-container">
                        <!-- Нотатки генеруються тут -->
                    </div>
                    <div class="text-center mt-4">
                        <button id="add-note-btn" class="add-character-btn">Додати запис</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Блок з банером -->
    <div class="support-banner-container">
        <a href="https://savelife.in.ua/donate/#donate-army-card-once" target="_blank" rel="noopener noreferrer" class="support-banner">
            <img src="https://savelife.in.ua/wp-content/themes/savelife/assets/images/logo-white.svg" alt="Логотип фонду Повернись живим" style="filter: invert(1);">
            <span>Підтримаймо наших захисників</span>
        </a>
    </div>

    <footer class="text-center text-gray-500 text-sm mt-4">
        <p>&copy; 2025 | <a href="#" id="about-link" class="underline">Про додаток</a></p>
    </footer>

    <!-- Модальне вікно "Про додаток" -->
    <div id="about-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-about-modal-btn" class="modal-close-btn">&times;</button>
            <h2>Про додаток</h2>
            <p>Цей додаток є неофіційним фанатським продуктом...</p>
        </div>
    </div>
    
    <!-- Модальне вікно "Дайс-роллер" -->
    <div id="dice-roller-modal" class="modal-overlay hidden">
        <div class="modal-content dice-roller">
            <button id="close-dice-modal-btn" class="modal-close-btn">&times;</button>
            <div class="dice-display">
                <span id="dice-formula"></span>
                <div id="dice-result-container" class="dice-result-container">
                    <div id="dice-animation" class="dice-icon"></div>
                    <span id="dice-result"></span>
                </div>
            </div>
            <div class="dice-buttons">
                <button data-dice="d100">d100</button>
                <button data-dice="d10">d10</button>
                <button data-dice="d8">d8</button>
                <button data-dice="d6">d6</button>
                <button data-dice="d4">d4</button>
                <button data-dice="d3">d3</button>
            </div>
            <div class="dice-controls">
                <button id="roll-dice-btn">Кидок</button>
                <button id="clear-dice-btn">Скинути</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
